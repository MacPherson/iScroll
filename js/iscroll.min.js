/* iScroll plugin */

;(function(v,r){var m,n=function(b,h){var k=Object.prototype.toString.call(b).slice(8,-1);return{isValid:k===h,getActual:k}},t={vertical:function(b,h,k,f,e,g){var d=parseInt(e.css("top")),c=f.outerHeight(!0)-e.outerHeight(!0),d=0>d?0:d>c?c:d;e.css("top",d);k=h.outerHeight(!0)-k.outerHeight(!0);f=f.outerHeight(!0)-e.outerHeight(!0);f=k/f*d;h.css("top",-f);g&&g.call(b,{pixel:d,percent:d/c*100},{pixel:0-f,percent:f/k*100},m)},horizontal:function(b,h,k,f,e,g){var d=parseInt(e.css("left")),c=f.outerWidth(!0)-
e.outerWidth(!0),d=0>d?0:d>c?c:d;e.css("left",d);k=h.outerWidth(!0)-k.outerWidth(!0);f=f.outerWidth(!0)-e.outerWidth(!0);f=k/f*d;h.css("left",-f);g.call(b,{pixel:d,percent:d/c*100},{pixel:0-f,percent:f/k*100})}};$.extend($.fn,{iScroll:function(b,h){if(1<$(this).length)return $(this).each(function(a,c){$.fn.iScroll.call($(c),b)});var k=n(b,"Function").isValid&&b||n(h,"Function").isValid&&h||$.noop(),f=$(this),e=$("."+(n(b,"Object").isValid&&b.text||"iscroll__text"),this),g=$("."+(n(b,"Object").isValid&&
b.minText||"iscroll__text_min"),this),d=$("."+(n(b,"Object").isValid&&b.scrollArea||"iscroll__bt"),this),c=$("."+(n(b,"Object").isValid&&b.scroll||"iscroll__bt_drag"),this),l=n(b,"Object").isValid&&b.direction||"vertical",p=[f,e,g,d,c,k],u=function(){return{vertical:function(){var a=g.outerHeight(!0)/e.outerHeight(!0)*d.outerHeight(!0);20>a&&(a=20);c.css("height",a)},horizontal:function(){var a=g.outerWidth(!0)/e.outerWidth(!0)*d.outerWidth(!0);20>a&&(a=20);c.css("width",a)}}}(),q={go:{vertical:function(){var a=
c.outerHeight(!0);t[l].apply(f,p);u[l]();0!==a-c.outerHeight(!0)&&(a=Math.abs(parseInt(e.css("top")))/((e.outerHeight(!0)-g.outerHeight(!0))/(d.outerHeight(!0)-c.outerHeight(!0))),c.css("top",a))},horizontal:function(){var a=c.outerWidth(!0);t[l].apply(f,p);u[l]();0!==a-c.outerWidth(!0)&&(a=Math.abs(parseInt(e.css("left")))/((e.outerWidth(!0)-g.outerWidth(!0))/(d.outerWidth(!0)-c.outerWidth(!0))),c.css("left",a))}},vertical:function(){f.on("mousewheel MozMousePixelScroll",function(a){var b=(d.height()-
c.height())/(e.outerHeight(!0)/g.outerHeight(!0)*10);1>b&&(b=1);"mousewheel"===a.type?(m=0<=a.originalEvent.wheelDelta?"up":"down",c.css("top",0<=a.originalEvent.wheelDelta?"-="+b:"+="+b)):(m=0>=a.originalEvent.detail?"up":"down",c.css("top",0>=a.originalEvent.detail?"-="+b:"+="+b));q.go[l]();a.preventDefault()});c.on("mousedown",function(a){var b=a.pageY-parseInt($(this).css("top")||0);$(r.body).on("mousemove.iScroll",function(a){m=0<a.pageY-b-parseInt(c.css("top"))?"down":"up";c.css("top",a.pageY-
b);q.go[l]()});return!1});return this},horizontal:function(){f.on("mousewheel MozMousePixelScroll",function(a){var b=(d.width()-c.width())/(e.outerWidth(!0)/g.outerWidth(!0)*10);1>b&&(b=1);"mousewheel"===a.type?(m=0<=a.originalEvent.wheelDelta?"right":"left",c.css("left",0<=a.originalEvent.wheelDelta?"-="+b:"+="+b)):(m=0>=a.originalEvent.detail?"right":"left",c.css("left",0>=a.originalEvent.detail?"-="+b:"+="+b));q.go[l]();a.preventDefault()});c.on("mousedown",function(a){var b=a.pageX-parseInt($(this).css("left")||
0);$(r.body).on("mousemove.iScroll",function(a){m=0<a.pageX-b-parseInt(c.css("left"))?"right":"left";c.css("left",a.pageX-b);q.go[l]()});return!1});return this},global:function(){$(r.body).on("mouseup",function(){$(this).off("mousemove.iScroll")});return this}};$.extend(f.data(),{direction:l,$scrollArea:d,$scroll:c,$text:e,$minText:g});u[l]();q[l]().global();return $(this)},iScrollTop:function(b,h,k){var f=!0,e;n(h,"Boolean").isValid?f=h:n(h,"Function").isValid?e=h:n(k,"Function").isValid&&(e=k);
if(1<$(this).length)return $(this).each(function(a,c){$.fn.iScrollTop.call($(c),b,e)});var g=$(this),d=$(this).data("direction"),c=$(b),l=0===b.indexOf(":");if(!l&&1>c.length)return e&&e.call(g,{done:!1,description:"Element not found. Selector: "+b}),g;var p=g.data("$text"),m=g.data("$minText");k=g.data("$scrollArea");h=g.data("$scroll");var q=[g,p,m,k,h],a,r;if("vertical"===d){l?(":start"===b&&(a=0),":end"===b&&(a=p.height()-m.height())):a=c.position().top;var s=a/p.height();a=k.height()*s;s={top:a};
r=4*Math.abs(a-parseInt(h.css("top")))}else"horizontal"===d&&(l?(":start"===b&&(a=0),":end"===b&&(a=p.width()-m.width())):a=c.position().left,s=a/p.width(),a=k.width()*s,s={left:a},r=4*Math.abs(a-parseInt(h.css("left"))));f?h.animate(s,{duration:r,progress:function(){t[d].apply(g,q)},done:function(){e&&e.call(g,{done:!0,description:"End animate to "+b+" element."})}}):(h.css(s),t[d].apply(g,q),e&&e.call(g,{done:!0,description:"End move to "+b+" element."}));return $(this)}})})(this,this.document);