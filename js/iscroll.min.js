/* iScroll plugin */

;(function(l,v){(function(){for(var b=["webkit","moz","o","ms"],k=0,h=0;h<b.length&&!l.requestAnimationFrame;++h)l.requestAnimationFrame=l[b[h]+"RequestAnimationFrame"],l.cancelAnimationFrame=l[b[h]+"CancelAnimationFrame"]||l[b[h]+"CancelRequestAnimationFrame"];l.requestAnimationFrame||(l.requestAnimationFrame=function(b,e){var f=(new Date).getTime(),c=Math.max(0,16-(f-k)),d=l.setTimeout(function(){b(f+c)},c);k=f+c;return d});l.cancelAnimationFrame||(l.cancelAnimationFrame=function(b){clearTimeout(b)})})();
var q,m,r,n=!1,s=function(b,k){var h=Object.prototype.toString.call(b).slice(8,-1);return{isValid:h===k,getActual:h}},u={vertical:function(b,k,h,g,e,f){var c=parseInt(e.css("top")),d=g.outerHeight(!0)-e.outerHeight(!0),c=0>c?0:c>d?d:c;e.css("top",c);h=k.outerHeight(!0)-h.outerHeight(!0);g=g.outerHeight(!0)-e.outerHeight(!0);g=h/g*c;k.css("top",-g);f&&f.call(b,{pixel:c,percent:c/d*100},{pixel:0-g,percent:g/h*100},q)},horizontal:function(b,k,h,g,e,f){var c=parseInt(e.css("left")),d=g.outerWidth(!0)-
e.outerWidth(!0),c=0>c?0:c>d?d:c;e.css("left",c);h=k.outerWidth(!0)-h.outerWidth(!0);g=g.outerWidth(!0)-e.outerWidth(!0);g=h/g*c;k.css("left",-g);f&&f.call(b,{pixel:c,percent:c/d*100},{pixel:0-g,percent:g/h*100})}};$.extend($.fn,{iScroll:function(b,k){if(1<$(this).length)return $(this).each(function(a,c){$.fn.iScroll.call($(c),b)});var h=s(b,"Function").isValid&&b||s(k,"Function").isValid&&k||$.noop(),g=$(this),e=$("."+(s(b,"Object").isValid&&b.text||"iscroll__text"),this),f=$("."+(s(b,"Object").isValid&&
b.minText||"iscroll__text_min"),this),c=$("."+(s(b,"Object").isValid&&b.scrollArea||"iscroll__bt"),this),d=$("."+(s(b,"Object").isValid&&b.scroll||"iscroll__bt_drag"),this),t=s(b,"Object").isValid&&b.direction||"vertical",l=[g,e,f,c,d,h],w=function(){return{vertical:function(){var a=f.outerHeight(!0)/e.outerHeight(!0)*c.outerHeight(!0);20>a&&(a=20);d.css("height",a)},horizontal:function(){var a=f.outerWidth(!0)/e.outerWidth(!0)*c.outerWidth(!0);20>a&&(a=20);d.css("width",a)}}}(),x={go:{vertical:function(){var a=
d.outerHeight(!0);u[t].apply(g,l);w[t]();0!==a-d.outerHeight(!0)&&(a=Math.abs(parseInt(e.css("top")))/((e.outerHeight(!0)-f.outerHeight(!0))/(c.outerHeight(!0)-d.outerHeight(!0))),d.css("top",a))},horizontal:function(){var a=d.outerWidth(!0);u[t].apply(g,l);w[t]();0!==a-d.outerWidth(!0)&&(a=Math.abs(parseInt(e.css("left")))/((e.outerWidth(!0)-f.outerWidth(!0))/(c.outerWidth(!0)-d.outerWidth(!0))),d.css("left",a))}},vertical:function(){var a;g.on("mousewheel MozMousePixelScroll",function(a){m="mousewheel";
n=!0;q="mousewheel"===a.type?0<=a.originalEvent.wheelDelta?"up":"down":0>=a.originalEvent.detail?"up":"down"});g.hover(function(){(function p(){r=requestAnimationFrame(p);n&&(n=!1,"mousewheel"===m&&(a=(c.height()-d.height())/(e.outerHeight(!0)/f.outerHeight(!0)*10),1>a&&(a=1),a=("up"===q?"-=":"+=")+a),d.css("top",a),x.go[t]())})()},function(){cancelAnimationFrame(r);r=void 0});d.mousedown(function(b){m="mousedown";var c=b.pageY-parseInt($(this).css("top")||0);$(v.body).on("mousemove.iScroll",function(b){n=
!0;q=0<b.pageY-c-parseInt(d.css("top"))?"down":"up";a=b.pageY-c});return!1}).mouseup(function(){m=null});return this},horizontal:function(){var a;g.on("mousewheel MozMousePixelScroll",function(a){m="mousewheel";n=!0;q="mousewheel"===a.type?0<=a.originalEvent.wheelDelta?"right":"left":0>=a.originalEvent.detail?"right":"left"});g.hover(function(){(function p(){r=requestAnimationFrame(p);n&&(n=!1,"mousewheel"===m&&(a=(c.width()-d.width())/(e.outerWidth(!0)/f.outerWidth(!0)*10),1>a&&(a=1),a=(/up|right/.test(q)?
"-=":"+=")+a),d.css("left",a),x.go[t]())})()},function(){cancelAnimationFrame(r);r=void 0});d.mousedown(function(b){m="mousedown";var c=b.pageX-parseInt($(this).css("left")||0);$(v.body).on("mousemove.iScroll",function(b){n=!0;q=0<b.pageX-c-parseInt(d.css("left"))?"right":"left";a=b.pageX-c});return!1}).mouseup(function(){m=null});return this},global:function(){$(v.body).on("mouseup",function(){$(this).off("mousemove.iScroll")});return this}};$.extend(g.data(),{direction:t,$scrollArea:c,$scroll:d,
$text:e,$minText:f});w[t]();x[t]().global();return $(this)},iScrollTop:function(b,k,h){var g=!0,e;s(k,"Boolean").isValid?g=k:s(k,"Function").isValid?e=k:s(h,"Function").isValid&&(e=h);if(1<$(this).length)return $(this).each(function(a,c){$.fn.iScrollTop.call($(c),b,e)});var f=$(this),c=$(this).data("direction"),d=$(b),l=0===b.indexOf(":");if(!l&&1>d.length)return e&&e.call(f,{done:!1,description:"Element not found. Selector: "+b}),f;var m=f.data("$text"),n=f.data("$minText");h=f.data("$scrollArea");
k=f.data("$scroll");var q=[f,m,n,h,k],a,r;if("vertical"===c){l?(":start"===b&&(a=0),":end"===b&&(a=m.height()-n.height())):a=d.position().top;var p=a/m.height();a=h.height()*p;p={top:a};r=4*Math.abs(a-parseInt(k.css("top")))}else"horizontal"===c&&(l?(":start"===b&&(a=0),":end"===b&&(a=m.width()-n.width())):a=d.position().left,p=a/m.width(),a=h.width()*p,p={left:a},r=4*Math.abs(a-parseInt(k.css("left"))));g?k.animate(p,{duration:r,progress:function(){u[c].apply(f,q)},done:function(){e&&e.call(f,{done:!0,
description:"End animate to "+b+" element."})}}):(k.css(p),u[c].apply(f,q),e&&e.call(f,{done:!0,description:"End move to "+b+" element."}));return $(this)}})})(this,this.document);
